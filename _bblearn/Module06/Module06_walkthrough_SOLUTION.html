
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Walkthrough &#8212; Quantitative Reasoning in Biology</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- So that users can add custom icons -->
  <script src="../../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script async="async" kind="hypothesis" src="https://hypothes.is/embed.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = '_bblearn/Module06/Module06_walkthrough_SOLUTION';</script>
    <link rel="canonical" href="https://damlabresources.github.io/quantitative-reasoning-in-biology/_bblearn/Module06/Module06_walkthrough_SOLUTION.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Lab" href="Module06_lab.html" />
    <link rel="prev" title="Grammar of Graphics" href="../../content/Module06/grammar_of_graphics.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../content/book_index.html">
  
  
  
  
  
  
    <p class="title logo__title">Quantitative Reasoning in Biology</p>
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../content/book_index.html">
                    Quantitative Reasoning in Biology
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Part 0: Introduction</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../content/misc/about_this_book.html">About this book</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Part 1 : Hello World</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../content/Module01/Module01_book.html">Module 1: Hello World</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../content/Module01/notebook_actions.html">Notebook basics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../content/Module01/Module01_walkthrough.html">Walkthrough</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../content/Module02/Module02_book.html">Module 2: Simple calculations</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../content/Module02/dilution_calculations.html">Molarity Calculations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Module02/Module02_walkthrough_SOLUTION.html">Walkthrough</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Module02/Module02_lab.html">Lab</a></li>


</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../content/Module03/Module03_book.html">Module 3: DataFrames</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../content/Module03/spreadsheet_organization.html">Spreadsheet Organization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Module03/Module03_walkthrough_SOLUTION.html">Walkthrough</a></li>

<li class="toctree-l2"><a class="reference internal" href="../Module03/Module03_lab.html">Lab</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Part 2 : Descriptive Statistics</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../content/Module04/Module04_book.html">Module 4: Analysis by groups</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../Module04/Module04_walkthrough_SOLUTION.html">Walkthrough</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../content/Module04/reshaping_data.html">Reshaping Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Module04/Module04_lab.html">Lab</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../content/Module05/Module05_book.html">Module 5: Plotting with Pandas</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../Module05/Module05_walkthrough_SOLUTION.html">Walkthrough</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Module05/Module05_lab.html">Lab</a></li>
</ul>
</details></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../../content/Module06/Module06_book.html">Module 6: Visualizing with Confidence</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../content/Module06/grammar_of_graphics.html">Grammar of Graphics</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Walkthrough</a></li>
<li class="toctree-l2"><a class="reference internal" href="Module06_lab.html">Lab</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../content/Module07/Module07_book.html">Module 7: Samples and Replicates</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../content/Module07/common_biological_distributions.html">Common Biological Distributions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Module07/Module07_walkthrough_SOLUTION.html">Walkthrough</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Module07/Module07_lab.html">Lab</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Part 3 : Inferential Statistics</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../content/Module08/Module08_book.html">Module 8: Hypothesis Testing</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../Module08/Module08_walkthrough_SOLUTION.html">Walkthrough</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Module08/Module08_lab.html">Lab</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../content/Module09/Module09_book.html">Module 9: Linear Regression</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../Module09/Module09_walkthrough_SOLUTION.html">Walkthrough</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Module09/Module09_lab.html">Lab</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../content/Module10/Module10_book.html">Module 10: Power Analysis</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../Module10/Module10_walkthrough_SOLUTION.html">Walkthrough</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Module10/Module10_lab.html">Lab</a></li>

</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Extra</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../content/misc/resources.html">Resources</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../content/faq.html">Frequently Asked Questions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../content/changelog.html">Change Log</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../content/misc/works_cited.html">Works Cited</a></li>
</ul>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/_bblearn/Module06/Module06_walkthrough_SOLUTION.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Walkthrough</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#learning-objectives">Learning Objectives</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#documentation">Documentation</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#categorical-comparisons">Categorical Comparisons</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#counting-with-countplot">Counting with <code class="docutils literal notranslate"><span class="pre">countplot</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#visualizing-differences-across-categories-with-stripplot">Visualizing differences across categories with <code class="docutils literal notranslate"><span class="pre">stripplot</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quantifying-the-uncertainty-of-estimates">Quantifying the uncertainty of estimates</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#measuring-spread">Measuring Spread</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#measuring-uncertainty">Measuring Uncertainty</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#comparing-distributions">Comparing Distributions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#measuring-correlation">Measuring Correlation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#figure-level-interface">Figure Level Interface</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#categorical-with-catplot">Categorical with <code class="docutils literal notranslate"><span class="pre">catplot</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#relational-with-relplot">Relational with <code class="docutils literal notranslate"><span class="pre">relplot</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#linear-model-regression-plots-with-lmplot">Linear model regression plots with <code class="docutils literal notranslate"><span class="pre">lmplot</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plotting-multiple-columns">Plotting Multiple Columns</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#i-m-pd-melting">I’m <code class="docutils literal notranslate"><span class="pre">pd.melt</span></code>ing</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="walkthrough">
<h1>Walkthrough<a class="headerlink" href="#walkthrough" title="Link to this heading">#</a></h1>
<section id="learning-objectives">
<h2>Learning Objectives<a class="headerlink" href="#learning-objectives" title="Link to this heading">#</a></h2>
<p>At the end of this learning activity you will be able to:</p>
<ul class="simple">
<li><p>Create categorical comparisons with countplots.</p></li>
<li><p>Create quantitative comparison plots with seaborn: stripplot, barplot, boxplot with Seaborn.</p></li>
<li><p>Create correlation style plots with with scatterplot and regplot.</p></li>
<li><p>Utilize <code class="docutils literal notranslate"><span class="pre">pd.melt</span></code> to plot wide data with seaborn.</p></li>
<li><p>Describe bootstapping and confidence intervals.</p></li>
</ul>
<p>This week we will continue our exploration of data from a cohort study participants of People Living with HIV (PLwH) here at Drexel.</p>
<p>As we discussed in the introduction, this data collection effort was done to provide a resource for many projects across the fields of HIV, aging, inflammation, neurocognitive impairment, immune function, and unknowable future projects.
In this walkthrough we will explore a collection of cytokines and chemokines measured by a Luminex panel of common biomarkers of inflammation.
We use this data to look for correlations between cytokine biomarkers and demographic variables.</p>
<section id="documentation">
<h3>Documentation<a class="headerlink" href="#documentation" title="Link to this heading">#</a></h3>
<p>I HIGHLY recommend exploring and utilizing the documentation for this tool:</p>
<ul class="simple">
<li><p>Base: <a class="reference external" href="https://seaborn.pydata.org/">https://seaborn.pydata.org/</a></p></li>
<li><p>Gallery of great examples: <a class="reference external" href="https://seaborn.pydata.org/examples/index.html">https://seaborn.pydata.org/examples/index.html</a></p></li>
<li><p>Function documentation: (We will be using the <em>Function Interface</em>. <a class="reference external" href="https://seaborn.pydata.org/api.html#function-interface">https://seaborn.pydata.org/api.html#function-interface</a></p></li>
<li><p>Tutorial: <a class="reference external" href="https://seaborn.pydata.org/tutorial.html">https://seaborn.pydata.org/tutorial.html</a></p></li>
</ul>
<p>When I’m making figures I’ll usually have the documentation open on another tab.</p>
<hr class="docutils" />
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="c1"># This is how we normally import seaborn</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">seaborn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sns</span>

<span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;cytokine_data.csv&#39;</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Sex</th>
      <th>Age</th>
      <th>isAA</th>
      <th>egf</th>
      <th>eotaxin</th>
      <th>fgfbasic</th>
      <th>gcsf</th>
      <th>gmcsf</th>
      <th>hgf</th>
      <th>ifnalpha</th>
      <th>...</th>
      <th>mig</th>
      <th>mip1alpha</th>
      <th>mip1beta</th>
      <th>tnfalpha</th>
      <th>vegf</th>
      <th>cocaine_use</th>
      <th>cannabinoid_use</th>
      <th>neuro_screen_impairment_level</th>
      <th>bmi</th>
      <th>years_infected</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Male</td>
      <td>53.0</td>
      <td>Checked</td>
      <td>65.01</td>
      <td>170.20</td>
      <td>50.32</td>
      <td>117.14</td>
      <td>2.51</td>
      <td>481.37</td>
      <td>110.79</td>
      <td>...</td>
      <td>185.29</td>
      <td>104.63</td>
      <td>151.15</td>
      <td>17.61</td>
      <td>7.54</td>
      <td>True</td>
      <td>True</td>
      <td>none</td>
      <td>21</td>
      <td>18</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Female</td>
      <td>62.0</td>
      <td>Checked</td>
      <td>232.83</td>
      <td>118.23</td>
      <td>36.03</td>
      <td>215.38</td>
      <td>24.53</td>
      <td>988.71</td>
      <td>66.13</td>
      <td>...</td>
      <td>397.24</td>
      <td>242.10</td>
      <td>230.87</td>
      <td>51.22</td>
      <td>31.60</td>
      <td>True</td>
      <td>True</td>
      <td>none</td>
      <td>22</td>
      <td>16</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Male</td>
      <td>60.0</td>
      <td>Checked</td>
      <td>84.84</td>
      <td>55.27</td>
      <td>13.22</td>
      <td>14.08</td>
      <td>0.48</td>
      <td>364.31</td>
      <td>78.67</td>
      <td>...</td>
      <td>18.63</td>
      <td>34.85</td>
      <td>68.34</td>
      <td>2.48</td>
      <td>0.84</td>
      <td>False</td>
      <td>False</td>
      <td>none</td>
      <td>25</td>
      <td>16</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Male</td>
      <td>62.0</td>
      <td>Checked</td>
      <td>24.13</td>
      <td>70.18</td>
      <td>4.12</td>
      <td>14.08</td>
      <td>1.33</td>
      <td>510.36</td>
      <td>118.64</td>
      <td>...</td>
      <td>118.63</td>
      <td>113.30</td>
      <td>49.15</td>
      <td>10.93</td>
      <td>3.53</td>
      <td>True</td>
      <td>True</td>
      <td>impaired</td>
      <td>29</td>
      <td>21</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Male</td>
      <td>54.0</td>
      <td>Checked</td>
      <td>186.98</td>
      <td>69.18</td>
      <td>32.56</td>
      <td>184.74</td>
      <td>12.55</td>
      <td>395.87</td>
      <td>40.79</td>
      <td>...</td>
      <td>140.56</td>
      <td>131.83</td>
      <td>241.00</td>
      <td>32.01</td>
      <td>10.81</td>
      <td>True</td>
      <td>True</td>
      <td>none</td>
      <td>26</td>
      <td>16</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 37 columns</p>
</div></div></div>
</div>
</section>
</section>
<section id="categorical-comparisons">
<h2>Categorical Comparisons<a class="headerlink" href="#categorical-comparisons" title="Link to this heading">#</a></h2>
<section id="counting-with-countplot">
<h3>Counting with <code class="docutils literal notranslate"><span class="pre">countplot</span></code><a class="headerlink" href="#counting-with-countplot" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">countplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">,</span> <span class="c1"># Pass the Dataframe `data` into the kwarg `data`</span>
              <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;neuro_screen_impairment_level&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Axes: xlabel=&#39;neuro_screen_impairment_level&#39;, ylabel=&#39;count&#39;&gt;
</pre></div>
</div>
<img alt="../../_images/551eab823686412da182ce1a35d5a1b4aacfa14a411f89f4cfcad07ea3811971.png" src="../../_images/551eab823686412da182ce1a35d5a1b4aacfa14a411f89f4cfcad07ea3811971.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">countplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">,</span> <span class="c1"># Pass the Dataframe `data` into the kwarg `data`</span>
              <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;neuro_screen_impairment_level&#39;</span><span class="p">,</span>
              <span class="n">hue</span> <span class="o">=</span> <span class="s1">&#39;cocaine_use&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Axes: xlabel=&#39;neuro_screen_impairment_level&#39;, ylabel=&#39;count&#39;&gt;
</pre></div>
</div>
<img alt="../../_images/aa4368fcb128bd498abff99f935f947128b34410ce5f36aef4e4f23177036b19.png" src="../../_images/aa4368fcb128bd498abff99f935f947128b34410ce5f36aef4e4f23177036b19.png" />
</div>
</div>
<p>If we wanted to look at multiple columns.
It would be wonderful if we could do this:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># This doesn&#39;t work</span>

<span class="c1"># sns.countplot(data = data,</span>
<span class="c1">#               x = &#39;neuro_screen_impairment_level&#39;,</span>
<span class="c1">#               hue = [&#39;cocaine_use&#39;, &#39;cannabinoid_use&#39;])</span>
</pre></div>
</div>
</div>
</div>
<p>But, we can create a new column that is the combination of the two:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">use_desc</span><span class="p">(</span><span class="n">row</span><span class="p">):</span>
    <span class="n">cocaine</span> <span class="o">=</span> <span class="s1">&#39;Y&#39;</span> <span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;cocaine_use&#39;</span><span class="p">]</span> <span class="k">else</span> <span class="s1">&#39;N&#39;</span>
    <span class="n">cannabinoid</span> <span class="o">=</span> <span class="s1">&#39;Y&#39;</span> <span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;cannabinoid_use&#39;</span><span class="p">]</span> <span class="k">else</span> <span class="s1">&#39;N&#39;</span>
    <span class="k">return</span> <span class="n">cocaine</span><span class="o">+</span><span class="n">cannabinoid</span>

<span class="n">data</span><span class="p">[</span><span class="s1">&#39;multi_use&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">use_desc</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>While we’re doing transformations, let’s improve our plots by converting our <code class="docutils literal notranslate"><span class="pre">neuro_screen_impairment_level</span></code> to a proper ordinal variable.</p>
<ul class="simple">
<li><p>Categorical variables : A set of distinct and seperable groups.</p></li>
<li><p>Ordinal variables : A set of distinct and seperable groups with a sortable order.</p></li>
</ul>
<p>By default, <code class="docutils literal notranslate"><span class="pre">pandas</span></code> treats all strings as <code class="docutils literal notranslate"><span class="pre">categorical</span></code> and it sorts them alphabetically.
But sometimes, we want to specify a order. We can do that like so.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">Categorical</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;neuro_screen_impairment_level&#39;</span><span class="p">],</span>
               <span class="n">categories</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="s1">&#39;mild&#39;</span><span class="p">,</span> <span class="s1">&#39;impaired&#39;</span><span class="p">],</span> <span class="n">ordered</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;none&#39;, &#39;none&#39;, &#39;none&#39;, &#39;impaired&#39;, &#39;none&#39;, ..., &#39;none&#39;, &#39;mild&#39;, &#39;mild&#39;, &#39;mild&#39;, &#39;mild&#39;]
Length: 224
Categories (3, object): [&#39;none&#39; &lt; &#39;mild&#39; &lt; &#39;impaired&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;neuro_screen_ordinal&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Categorical</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;neuro_screen_impairment_level&#39;</span><span class="p">],</span>
                                               <span class="n">categories</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="s1">&#39;mild&#39;</span><span class="p">,</span> <span class="s1">&#39;impaired&#39;</span><span class="p">],</span> <span class="n">ordered</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">countplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">,</span> <span class="c1"># Pass the Dataframe `data` into the kwarg `data`</span>
              <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;neuro_screen_ordinal&#39;</span><span class="p">,</span> <span class="c1"># Seaborn will respect the ordering of our categories.</span>
              <span class="n">hue</span> <span class="o">=</span> <span class="s1">&#39;multi_use&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Axes: xlabel=&#39;neuro_screen_ordinal&#39;, ylabel=&#39;count&#39;&gt;
</pre></div>
</div>
<img alt="../../_images/fa980573b62ec0f82df1f1357d76745c53de62c462ec2959460019d84829085d.png" src="../../_images/fa980573b62ec0f82df1f1357d76745c53de62c462ec2959460019d84829085d.png" />
</div>
</div>
</section>
<section id="visualizing-differences-across-categories-with-stripplot">
<h3>Visualizing differences across categories with <code class="docutils literal notranslate"><span class="pre">stripplot</span></code><a class="headerlink" href="#visualizing-differences-across-categories-with-stripplot" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">stripplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">,</span>
              <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;neuro_screen_ordinal&#39;</span><span class="p">,</span>
              <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;mcp1&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Axes: xlabel=&#39;neuro_screen_ordinal&#39;, ylabel=&#39;mcp1&#39;&gt;
</pre></div>
</div>
<img alt="../../_images/e18406e04c14272f53e8cec4478aa809c4150c316225fffe8bfc9d5da60644cd.png" src="../../_images/e18406e04c14272f53e8cec4478aa809c4150c316225fffe8bfc9d5da60644cd.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">stripplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">,</span>
              <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;neuro_screen_ordinal&#39;</span><span class="p">,</span>
              <span class="n">hue</span> <span class="o">=</span> <span class="s1">&#39;Sex&#39;</span><span class="p">,</span>
              <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;mcp1&#39;</span><span class="p">)</span>
<span class="c1"># Try dodge = True</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Axes: xlabel=&#39;neuro_screen_ordinal&#39;, ylabel=&#39;mcp1&#39;&gt;
</pre></div>
</div>
<img alt="../../_images/da66129147cf5df4d7517d2812cbef7bd0de6bf8652ab186e04d09e5ad1cea41.png" src="../../_images/da66129147cf5df4d7517d2812cbef7bd0de6bf8652ab186e04d09e5ad1cea41.png" />
</div>
</div>
<p>You can even put plots on top of plots!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Grab the axis object that was created</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">stripplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">,</span>
                   <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;neuro_screen_ordinal&#39;</span><span class="p">,</span>
                   <span class="n">hue</span> <span class="o">=</span> <span class="s1">&#39;Sex&#39;</span><span class="p">,</span>
                   <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;mcp1&#39;</span><span class="p">,</span>
                   <span class="n">dodge</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>


<span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">,</span>
              <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;neuro_screen_ordinal&#39;</span><span class="p">,</span>
              <span class="n">hue</span> <span class="o">=</span> <span class="s1">&#39;Sex&#39;</span><span class="p">,</span>
              <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;mcp1&#39;</span><span class="p">,</span>
              <span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span><span class="p">)</span> <span class="c1"># Give that axis to the next plot</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Axes: xlabel=&#39;neuro_screen_ordinal&#39;, ylabel=&#39;mcp1&#39;&gt;
</pre></div>
</div>
<img alt="../../_images/a09941e9459460f3dfe6ed69bb835580456e0d8719ea543077aaaba5b3674b4f.png" src="../../_images/a09941e9459460f3dfe6ed69bb835580456e0d8719ea543077aaaba5b3674b4f.png" />
</div>
</div>
</section>
</section>
<section id="quantifying-the-uncertainty-of-estimates">
<h2>Quantifying the uncertainty of estimates<a class="headerlink" href="#quantifying-the-uncertainty-of-estimates" title="Link to this heading">#</a></h2>
<p>When presenting data it is important to rigorously convey the precision and uncertainty of our estimates.
I HIGHLY recommend reading the error bar tutorial in seaborn.
Below is a quick summary.</p>
<blockquote>
<div><p>The error bars around an estimate of central tendency can show one of two general things: either the range of uncertainty about the estimate or the spread of the underlying data around it.
These measures are related: given the same sample size, estimates will be more uncertain when data has a broader spread. But uncertainty will decrease as sample sizes grow, whereas spread will not.</p>
</div></blockquote>
<p><img alt="Error bar taxonomy" src="https://seaborn.pydata.org/_images/error_bars_2_0.svg" /></p>
<ul>
<li><p>Value Spread: How much each value differs from every other value</p>
<ul class="simple">
<li><p>Standard deviation: Average difference of each point from the mean.</p></li>
<li><p>Percentile Interval: Middle range that contains some percent of the data.</p></li>
</ul>
</li>
<li><p>Estimate Uncertainty: What is the reasonable range of my estimate</p>
<ul class="simple">
<li><p>Standard Error: Standard deviation/sqrt(sample_size)</p></li>
<li><p>Confidence Intervals:</p></li>
</ul>
<blockquote>
<div><p>The nonparametric approach to representing uncertainty uses bootstrapping: a procedure where the dataset is randomly resampled with replacement a number of times, and the estimate is recalculated from each resample. This procedure creates a distribution of statistics approximating the distribution of values that you could have gotten for your estimate if you had a different sample.</p>
</div></blockquote>
</li>
</ul>
<section id="measuring-spread">
<h3>Measuring Spread<a class="headerlink" href="#measuring-spread" title="Link to this heading">#</a></h3>
<p>Quantifies how much each individual measurement vary around the middle.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Parametric Assumptions</span>

<span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">par_ax</span><span class="p">,</span> <span class="n">np_ax</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1">## Plot with parametric assumpitions</span>
<span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">,</span>
            <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;neuro_screen_ordinal&#39;</span><span class="p">,</span>
            <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;mcp1&#39;</span><span class="p">,</span>
            <span class="n">estimator</span> <span class="o">=</span> <span class="s1">&#39;mean&#39;</span><span class="p">,</span>
            <span class="n">errorbar</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;sd&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
                <span class="n">ax</span> <span class="o">=</span> <span class="n">par_ax</span><span class="p">)</span> <span class="c1"># 95% CI</span>

<span class="n">sns</span><span class="o">.</span><span class="n">stripplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">,</span>
              <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;neuro_screen_ordinal&#39;</span><span class="p">,</span>
              <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;mcp1&#39;</span><span class="p">,</span>
              <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
              <span class="n">ax</span><span class="o">=</span><span class="n">par_ax</span><span class="p">)</span>
<span class="n">par_ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Parametric&#39;</span><span class="p">)</span>

<span class="c1">## Plot with non-parametric methods</span>

<span class="c1">## Plot with parametric assumpitions</span>
<span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">,</span>
            <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;neuro_screen_ordinal&#39;</span><span class="p">,</span>
            <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;mcp1&#39;</span><span class="p">,</span>
            <span class="n">estimator</span> <span class="o">=</span> <span class="s1">&#39;median&#39;</span><span class="p">,</span>
            <span class="n">errorbar</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;pi&#39;</span><span class="p">,</span> <span class="mi">95</span><span class="p">),</span>
                <span class="n">ax</span> <span class="o">=</span> <span class="n">np_ax</span><span class="p">)</span> <span class="c1"># 95% CI</span>

<span class="n">sns</span><span class="o">.</span><span class="n">stripplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">,</span>
              <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;neuro_screen_ordinal&#39;</span><span class="p">,</span>
              <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;mcp1&#39;</span><span class="p">,</span>
              <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
              <span class="n">ax</span><span class="o">=</span><span class="n">np_ax</span><span class="p">)</span>

<span class="n">np_ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Non-Parametric&#39;</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/7f9fab85893d521ab60799d72aac22ce41f2d63b26fc77a351777c51472dc37b.png" src="../../_images/7f9fab85893d521ab60799d72aac22ce41f2d63b26fc77a351777c51472dc37b.png" />
</div>
</div>
</section>
<section id="measuring-uncertainty">
<h3>Measuring Uncertainty<a class="headerlink" href="#measuring-uncertainty" title="Link to this heading">#</a></h3>
<p>Quantifies how confident we are about where the middle of the distribution is.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Parametric Assumptions</span>

<span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">par_ax</span><span class="p">,</span> <span class="n">np_ax</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1">## Plot with parametric assumpitions</span>
<span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">,</span>
            <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;neuro_screen_ordinal&#39;</span><span class="p">,</span>
            <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;mcp1&#39;</span><span class="p">,</span>
            <span class="n">estimator</span> <span class="o">=</span> <span class="s1">&#39;mean&#39;</span><span class="p">,</span>
            <span class="n">errorbar</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;se&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
                <span class="n">ax</span> <span class="o">=</span> <span class="n">par_ax</span><span class="p">)</span>

<span class="n">sns</span><span class="o">.</span><span class="n">stripplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">,</span>
              <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;neuro_screen_ordinal&#39;</span><span class="p">,</span>
              <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;mcp1&#39;</span><span class="p">,</span>
              <span class="n">alpha</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span>
              <span class="n">ax</span><span class="o">=</span><span class="n">par_ax</span><span class="p">)</span>
<span class="n">par_ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Parametric&#39;</span><span class="p">)</span>

<span class="c1">## Plot with non-parametric methods</span>
<span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">,</span>
            <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;neuro_screen_ordinal&#39;</span><span class="p">,</span>
            <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;mcp1&#39;</span><span class="p">,</span>
            <span class="n">estimator</span> <span class="o">=</span> <span class="s1">&#39;median&#39;</span><span class="p">,</span>
            <span class="n">errorbar</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;ci&#39;</span><span class="p">,</span> <span class="mi">95</span><span class="p">),</span>
                <span class="n">ax</span> <span class="o">=</span> <span class="n">np_ax</span><span class="p">)</span>

<span class="n">sns</span><span class="o">.</span><span class="n">stripplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">,</span>
              <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;neuro_screen_ordinal&#39;</span><span class="p">,</span>
              <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;mcp1&#39;</span><span class="p">,</span>
              <span class="n">alpha</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span>
              <span class="n">ax</span><span class="o">=</span><span class="n">np_ax</span><span class="p">)</span>

<span class="n">np_ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Non-Parametric&#39;</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/9ec90e1bb748322eeec6c2f010e1e974fbf7f6dfb64bad683a61f47dff2a3a5f.png" src="../../_images/9ec90e1bb748322eeec6c2f010e1e974fbf7f6dfb64bad683a61f47dff2a3a5f.png" />
</div>
</div>
<p>With hundreds of data points, we are very confident and precise about our estimate of the middle of the distribution.</p>
<p>It is important to understand the effect of sample size on spread and uncertainty.
Below is a simulation that picks small subsets of the data and generates the same plot.
Before you generate it; which do you think will change with sample-size and which will stay the same?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">overlapped_plot</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;mcp1&#39;</span><span class="p">,</span> <span class="n">mode</span> <span class="o">=</span> <span class="s1">&#39;spread&#39;</span><span class="p">):</span>
    <span class="s2">&quot;Create overlapped plot with different confidence assumptions&quot;</span>

    <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;spread&#39;</span><span class="p">:</span>
        <span class="c1"># Use Standard Deviation</span>
        <span class="n">eb</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;sd&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;uncertainty&#39;</span><span class="p">:</span>
        <span class="c1"># Use Standard error</span>
        <span class="n">eb</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;se&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Expected spread or uncertainty, got: </span><span class="si">{</span><span class="n">mode</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">df</span><span class="p">,</span>
                <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;neuro_screen_ordinal&#39;</span><span class="p">,</span>
                <span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="p">,</span>
                <span class="n">errorbar</span> <span class="o">=</span> <span class="n">eb</span><span class="p">,</span>
                <span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span><span class="p">)</span>

    <span class="n">sns</span><span class="o">.</span><span class="n">stripplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">df</span><span class="p">,</span>
                  <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;neuro_screen_ordinal&#39;</span><span class="p">,</span>
                  <span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="p">,</span>
                  <span class="n">alpha</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span>
                  <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">NBINS</span> <span class="o">=</span> <span class="mi">10</span>

<span class="n">BINS</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">index</span><span class="p">),</span> <span class="n">NBINS</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">BINS</span><span class="p">),</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">50</span><span class="p">),</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="k">for</span> <span class="n">row</span><span class="p">,</span> <span class="n">sample_size</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">BINS</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Sampling&#39;</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">sample_size</span><span class="p">),</span> <span class="s1">&#39;samples for figure.&#39;</span><span class="p">)</span>
    <span class="n">ndf</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">sample_size</span><span class="p">))</span>

    <span class="n">spread_ax</span><span class="p">,</span> <span class="n">uncer_ax</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="n">row</span><span class="p">,:]</span>

    <span class="c1">## Plot with parametric assumpitions</span>
    <span class="n">overlapped_plot</span><span class="p">(</span><span class="n">spread_ax</span><span class="p">,</span> <span class="n">ndf</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;spread&#39;</span><span class="p">)</span>
    <span class="n">spread_ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Spread: n = </span><span class="si">{</span><span class="n">sample_size</span><span class="si">:</span><span class="s1">0.0f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="c1">## Plot with parametric assumpitions</span>
    <span class="n">overlapped_plot</span><span class="p">(</span><span class="n">uncer_ax</span><span class="p">,</span> <span class="n">ndf</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;uncertainty&#39;</span><span class="p">)</span>
    <span class="n">uncer_ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Uncertainty: n = </span><span class="si">{</span><span class="n">sample_size</span><span class="si">:</span><span class="s1">0.0f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Sampling 10 samples for figure.
Sampling 33 samples for figure.
Sampling 57 samples for figure.
Sampling 81 samples for figure.
Sampling 105 samples for figure.
Sampling 128 samples for figure.
Sampling 152 samples for figure.
Sampling 176 samples for figure.
Sampling 200 samples for figure.
Sampling 224 samples for figure.
</pre></div>
</div>
<img alt="../../_images/7fd97bc98da345a05804a1b488c669b733c7480b5b01d69e5a2a2ca626502ccb.png" src="../../_images/7fd97bc98da345a05804a1b488c669b733c7480b5b01d69e5a2a2ca626502ccb.png" />
</div>
</div>
<div class="cell tag_otter_assign_solution_cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Which is impacted by sample size?</span>
<span class="c1"># answer: &#39;spread&#39;, &#39;uncertainty&#39;, &#39;both&#39;, &#39;neither&#39;</span>
<span class="n">impact_of_sample_size</span> <span class="o">=</span> <span class="s1">&#39;uncertainty&#39;</span> <span class="c1"># SOLUTION</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">grader</span><span class="o">.</span><span class="n">check</span><span class="p">(</span><span class="s2">&quot;impact_of_sample_size&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>So, how are the two measures impacted by sample size?</p>
<ul class="simple">
<li><p>Spread : Sample size has no effect on spread.</p></li>
<li><p>Uncertainty : Sample size reduces uncertainty.</p></li>
</ul>
<p>This type of categorical visualization is limited in that it only considers a single summary statistic.
It ignores the “shape” of the data.
We can use histograms to explore this.</p>
</section>
</section>
<section id="comparing-distributions">
<h2>Comparing Distributions<a class="headerlink" href="#comparing-distributions" title="Link to this heading">#</a></h2>
<p>Seaborn makes simple graphs easy.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">,</span>
             <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;mcp1&#39;</span><span class="p">,</span>
             <span class="n">hue</span> <span class="o">=</span> <span class="s1">&#39;neuro_screen_ordinal&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Axes: xlabel=&#39;mcp1&#39;, ylabel=&#39;Count&#39;&gt;
</pre></div>
</div>
<img alt="../../_images/1826a852a744e3fce82ae551efffc99b6712e1afb657d4834a743bd249389ddd.png" src="../../_images/1826a852a744e3fce82ae551efffc99b6712e1afb657d4834a743bd249389ddd.png" />
</div>
</div>
<p>If we don’t like overlapping plots we can make it like a heatmap where the color indicates the count.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">,</span>
             <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;mcp1&#39;</span><span class="p">,</span>
             <span class="n">y</span>  <span class="o">=</span> <span class="s1">&#39;neuro_screen_ordinal&#39;</span><span class="p">,</span>
             <span class="n">cbar</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Axes: xlabel=&#39;mcp1&#39;, ylabel=&#39;neuro_screen_ordinal&#39;&gt;
</pre></div>
</div>
<img alt="../../_images/1141d3a49959c977d255d7bfae9ece6012af71102debc71bcb4e829d334a911b.png" src="../../_images/1141d3a49959c977d255d7bfae9ece6012af71102debc71bcb4e829d334a911b.png" />
</div>
</div>
<p>Aggregate statistic to compute in each bin.</p>
<ul class="simple">
<li><p>count: show the number of observations in each bin</p></li>
<li><p>frequency: show the number of observations divided by the bin width</p></li>
<li><p>probability or proportion: normalize such that bar heights sum to 1</p></li>
<li><p>percent: normalize such that bar heights sum to 100</p></li>
<li><p>density: normalize such that the total area of the histogram equals 1</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">,</span>
             <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;mcp1&#39;</span><span class="p">,</span>
             <span class="n">hue</span> <span class="o">=</span> <span class="s1">&#39;neuro_screen_ordinal&#39;</span><span class="p">,</span>
             <span class="n">stat</span> <span class="o">=</span> <span class="s1">&#39;percent&#39;</span><span class="p">,</span>
             <span class="n">common_norm</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="c1"># Each group should have its own &quot;sum to 100&quot;</span>
<span class="c1"># hue_order = [&#39;none&#39;, &#39;mild&#39;]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Axes: xlabel=&#39;mcp1&#39;, ylabel=&#39;Percent&#39;&gt;
</pre></div>
</div>
<img alt="../../_images/1d61e048c5e2eb7c99699a7d9af073639c6e65e82a76184cf55bbed34ba815d0.png" src="../../_images/1d61e048c5e2eb7c99699a7d9af073639c6e65e82a76184cf55bbed34ba815d0.png" />
</div>
</div>
</section>
<section id="measuring-correlation">
<h2>Measuring Correlation<a class="headerlink" href="#measuring-correlation" title="Link to this heading">#</a></h2>
<p>The previous figures measured one (or more) categorical variables and a single quantitative variable.
If we want to understand how correlated any two quantitative variables are to each other.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">,</span>
                <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;mcp1&#39;</span><span class="p">,</span> 
                <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;tnfalpha&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Axes: xlabel=&#39;mcp1&#39;, ylabel=&#39;tnfalpha&#39;&gt;
</pre></div>
</div>
<img alt="../../_images/33bb7b98f775b3a06cf701117b8bdf46a810ef9e2029c5a75920e2016d2186e5.png" src="../../_images/33bb7b98f775b3a06cf701117b8bdf46a810ef9e2029c5a75920e2016d2186e5.png" />
</div>
</div>
<p>We can also use a <em>regression plot</em> to draw a best fit line with a confidence interval indicated by a shadow.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">regplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">,</span>
            <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;mcp1&#39;</span><span class="p">,</span>
            <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;tnfalpha&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Axes: xlabel=&#39;mcp1&#39;, ylabel=&#39;tnfalpha&#39;&gt;
</pre></div>
</div>
<img alt="../../_images/a472026b363968d69773e7b1988b91085afe378b501d4ee14c07e42a27f46d25.png" src="../../_images/a472026b363968d69773e7b1988b91085afe378b501d4ee14c07e42a27f46d25.png" />
</div>
</div>
</section>
<section id="figure-level-interface">
<h2>Figure Level Interface<a class="headerlink" href="#figure-level-interface" title="Link to this heading">#</a></h2>
<p>All of the code we’ve been running above generates a single figure.
The functions below automate generating multiple figures across different facets of the data.
This is an incredibly useful way to explore relationships in your data.</p>
<section id="categorical-with-catplot">
<h3>Categorical with <code class="docutils literal notranslate"><span class="pre">catplot</span></code><a class="headerlink" href="#categorical-with-catplot" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">catplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">,</span>
            <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;neuro_screen_ordinal&#39;</span><span class="p">,</span>
            <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;mcp1&#39;</span><span class="p">,</span>
            <span class="n">col</span> <span class="o">=</span> <span class="s1">&#39;multi_use&#39;</span><span class="p">)</span>

<span class="c1"># Try:</span>
<span class="c1"># col_wrap = 2</span>
<span class="c1"># kind = &#39;bar&#39;, box, etc</span>
<span class="c1"># Other groupings across row and hue</span>
<span class="c1">#  Sex, isAA</span>
<span class="c1">#  pd.cut(data[&#39;Age&#39;], [18, 30, 50, 100], labels=[&#39;young&#39;, &#39;adult&#39;, &#39;aged&#39;])</span>
<span class="c1">#  pd.cut(data[&#39;tnfalpha&#39;], 3, labels=[&#39;low&#39;, &#39;med&#39;, &#39;high&#39;])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;seaborn.axisgrid.FacetGrid at 0x7f0d1f55fa60&gt;
</pre></div>
</div>
<img alt="../../_images/6a01b0cc2e7190029a4256c4f5065d071498eb549facd1bdf5b137e84feb700e.png" src="../../_images/6a01b0cc2e7190029a4256c4f5065d071498eb549facd1bdf5b137e84feb700e.png" />
</div>
</div>
<p>Each of the plots splits the data into a different categorical subset, then only plots the data within that set.
Use the examples in the comments to explore ways to visualize the data.</p>
</section>
<section id="relational-with-relplot">
<h3>Relational with <code class="docutils literal notranslate"><span class="pre">relplot</span></code><a class="headerlink" href="#relational-with-relplot" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">relplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">,</span>
            <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;tnfalpha&#39;</span><span class="p">,</span>
            <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;mcp1&#39;</span><span class="p">,</span>
            <span class="n">col</span> <span class="o">=</span> <span class="s1">&#39;multi_use&#39;</span><span class="p">)</span>

<span class="c1"># Try:</span>
<span class="c1"># col_wrap = 2</span>
<span class="c1"># kind = &#39;bar&#39;, box, etc</span>
<span class="c1"># Other groupings across row and hue</span>
<span class="c1">#  Sex, isAA</span>
<span class="c1">#  pd.cut(data[&#39;Age&#39;], [18, 30, 50, 100], labels=[&#39;young&#39;, &#39;adult&#39;, &#39;aged&#39;])</span>
<span class="c1">#  pd.cut(data[&#39;tnfalpha&#39;], 3, labels=[&#39;low&#39;, &#39;med&#39;, &#39;high&#39;])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;seaborn.axisgrid.FacetGrid at 0x7f0d1f2f3b20&gt;
</pre></div>
</div>
<img alt="../../_images/3432734424e6dd3fb01e315c3197aabc48bda892207fafb187637b0f3ee819ae.png" src="../../_images/3432734424e6dd3fb01e315c3197aabc48bda892207fafb187637b0f3ee819ae.png" />
</div>
</div>
</section>
<section id="linear-model-regression-plots-with-lmplot">
<h3>Linear model regression plots with <code class="docutils literal notranslate"><span class="pre">lmplot</span></code><a class="headerlink" href="#linear-model-regression-plots-with-lmplot" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">lmplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">,</span>
            <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;tnfalpha&#39;</span><span class="p">,</span>
            <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;mcp1&#39;</span><span class="p">,</span>
            <span class="n">col</span> <span class="o">=</span> <span class="s1">&#39;multi_use&#39;</span><span class="p">)</span>
<span class="c1"># Try:</span>
<span class="c1"># col_wrap = 2</span>
<span class="c1"># kind = &#39;bar&#39;, box, etc</span>
<span class="c1"># Other groupings across row and hue</span>
<span class="c1">#  Sex, isAA</span>
<span class="c1">#  pd.cut(data[&#39;Age&#39;], [18, 30, 50, 100], labels=[&#39;young&#39;, &#39;adult&#39;, &#39;aged&#39;])</span>
<span class="c1">#  pd.cut(data[&#39;tnfalpha&#39;], 3, labels=[&#39;low&#39;, &#39;med&#39;, &#39;high&#39;])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;seaborn.axisgrid.FacetGrid at 0x7f0d1d5d6760&gt;
</pre></div>
</div>
<img alt="../../_images/ad4565986b77a72d0085e30551c9d322f18ae790571dfa42bece70d168838784.png" src="../../_images/ad4565986b77a72d0085e30551c9d322f18ae790571dfa42bece70d168838784.png" />
</div>
</div>
</section>
</section>
<section id="plotting-multiple-columns">
<h2>Plotting Multiple Columns<a class="headerlink" href="#plotting-multiple-columns" title="Link to this heading">#</a></h2>
<p>You’ll probably notice that all of the graphs so far have visualized a single cytokine.
What if we wanted multiple cytokines in the same figure?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># This doesn&#39;t work</span>
<span class="c1"># sns.stripplot(data = data,</span>
<span class="c1">#               x = &#39;neuro_screen_category&#39;,</span>
<span class="c1">#               hue = &#39;Sex&#39;,</span>
<span class="c1">#               y = [&#39;mcp1&#39;, &#39;tnfalpha&#39;],</span>
<span class="c1">#               dodge = True)</span>
</pre></div>
</div>
</div>
</div>
<section id="i-m-pd-melting">
<h3>I’m <code class="docutils literal notranslate"><span class="pre">pd.melt</span></code>ing<a class="headerlink" href="#i-m-pd-melting" title="Link to this heading">#</a></h3>
<p>Seaborn only plots <em>long</em> data.
We need to convert our <em>wide</em> data into <em>long</em> data first.
This is melting.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Sex</th>
      <th>Age</th>
      <th>isAA</th>
      <th>egf</th>
      <th>eotaxin</th>
      <th>fgfbasic</th>
      <th>gcsf</th>
      <th>gmcsf</th>
      <th>hgf</th>
      <th>ifnalpha</th>
      <th>...</th>
      <th>mip1beta</th>
      <th>tnfalpha</th>
      <th>vegf</th>
      <th>cocaine_use</th>
      <th>cannabinoid_use</th>
      <th>neuro_screen_impairment_level</th>
      <th>bmi</th>
      <th>years_infected</th>
      <th>multi_use</th>
      <th>neuro_screen_ordinal</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Male</td>
      <td>53.0</td>
      <td>Checked</td>
      <td>65.01</td>
      <td>170.20</td>
      <td>50.32</td>
      <td>117.14</td>
      <td>2.51</td>
      <td>481.37</td>
      <td>110.79</td>
      <td>...</td>
      <td>151.15</td>
      <td>17.61</td>
      <td>7.54</td>
      <td>True</td>
      <td>True</td>
      <td>none</td>
      <td>21</td>
      <td>18</td>
      <td>YY</td>
      <td>none</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Female</td>
      <td>62.0</td>
      <td>Checked</td>
      <td>232.83</td>
      <td>118.23</td>
      <td>36.03</td>
      <td>215.38</td>
      <td>24.53</td>
      <td>988.71</td>
      <td>66.13</td>
      <td>...</td>
      <td>230.87</td>
      <td>51.22</td>
      <td>31.60</td>
      <td>True</td>
      <td>True</td>
      <td>none</td>
      <td>22</td>
      <td>16</td>
      <td>YY</td>
      <td>none</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Male</td>
      <td>60.0</td>
      <td>Checked</td>
      <td>84.84</td>
      <td>55.27</td>
      <td>13.22</td>
      <td>14.08</td>
      <td>0.48</td>
      <td>364.31</td>
      <td>78.67</td>
      <td>...</td>
      <td>68.34</td>
      <td>2.48</td>
      <td>0.84</td>
      <td>False</td>
      <td>False</td>
      <td>none</td>
      <td>25</td>
      <td>16</td>
      <td>NN</td>
      <td>none</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Male</td>
      <td>62.0</td>
      <td>Checked</td>
      <td>24.13</td>
      <td>70.18</td>
      <td>4.12</td>
      <td>14.08</td>
      <td>1.33</td>
      <td>510.36</td>
      <td>118.64</td>
      <td>...</td>
      <td>49.15</td>
      <td>10.93</td>
      <td>3.53</td>
      <td>True</td>
      <td>True</td>
      <td>impaired</td>
      <td>29</td>
      <td>21</td>
      <td>YY</td>
      <td>impaired</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Male</td>
      <td>54.0</td>
      <td>Checked</td>
      <td>186.98</td>
      <td>69.18</td>
      <td>32.56</td>
      <td>184.74</td>
      <td>12.55</td>
      <td>395.87</td>
      <td>40.79</td>
      <td>...</td>
      <td>241.00</td>
      <td>32.01</td>
      <td>10.81</td>
      <td>True</td>
      <td>True</td>
      <td>none</td>
      <td>26</td>
      <td>16</td>
      <td>YY</td>
      <td>none</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 39 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">melted_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">data</span><span class="p">,</span>
                      <span class="n">id_vars</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Sex&#39;</span><span class="p">,</span> <span class="s1">&#39;Age&#39;</span><span class="p">,</span> <span class="s1">&#39;neuro_screen_ordinal&#39;</span><span class="p">,</span> <span class="s1">&#39;multi_use&#39;</span><span class="p">],</span> <span class="c1"># What we want replicated across all rows of the same sample</span>
                      <span class="n">value_vars</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;mcp1&#39;</span><span class="p">,</span> <span class="s1">&#39;tnfalpha&#39;</span><span class="p">,</span> <span class="s1">&#39;il6&#39;</span><span class="p">],</span> <span class="c1"># What columns we want to melt into rows</span>
                      <span class="n">value_name</span> <span class="o">=</span> <span class="s1">&#39;concentration&#39;</span><span class="p">,</span> <span class="c1"># The name of the value column after melting</span>
                      <span class="n">var_name</span> <span class="o">=</span> <span class="s1">&#39;cytokine&#39;</span><span class="p">)</span> <span class="c1"># The name of the variable column after melting</span>
<span class="n">melted_data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Sex</th>
      <th>Age</th>
      <th>neuro_screen_ordinal</th>
      <th>multi_use</th>
      <th>cytokine</th>
      <th>concentration</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Male</td>
      <td>53.0</td>
      <td>none</td>
      <td>YY</td>
      <td>mcp1</td>
      <td>468.72</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Female</td>
      <td>62.0</td>
      <td>none</td>
      <td>YY</td>
      <td>mcp1</td>
      <td>591.70</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Male</td>
      <td>60.0</td>
      <td>none</td>
      <td>NN</td>
      <td>mcp1</td>
      <td>132.80</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Male</td>
      <td>62.0</td>
      <td>impaired</td>
      <td>YY</td>
      <td>mcp1</td>
      <td>816.71</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Male</td>
      <td>54.0</td>
      <td>none</td>
      <td>YY</td>
      <td>mcp1</td>
      <td>414.97</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>667</th>
      <td>Male</td>
      <td>44.0</td>
      <td>none</td>
      <td>NN</td>
      <td>il6</td>
      <td>16.69</td>
    </tr>
    <tr>
      <th>668</th>
      <td>Male</td>
      <td>59.0</td>
      <td>mild</td>
      <td>YY</td>
      <td>il6</td>
      <td>15.55</td>
    </tr>
    <tr>
      <th>669</th>
      <td>Male</td>
      <td>63.0</td>
      <td>mild</td>
      <td>YY</td>
      <td>il6</td>
      <td>11.94</td>
    </tr>
    <tr>
      <th>670</th>
      <td>Male</td>
      <td>41.0</td>
      <td>mild</td>
      <td>NY</td>
      <td>il6</td>
      <td>12.48</td>
    </tr>
    <tr>
      <th>671</th>
      <td>Male</td>
      <td>43.0</td>
      <td>mild</td>
      <td>NN</td>
      <td>il6</td>
      <td>2.40</td>
    </tr>
  </tbody>
</table>
<p>672 rows × 6 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">catplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">melted_data</span><span class="p">,</span>
            <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;neuro_screen_ordinal&#39;</span><span class="p">,</span>
            <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;concentration&#39;</span><span class="p">,</span>
            <span class="n">col</span> <span class="o">=</span> <span class="s1">&#39;cytokine&#39;</span><span class="p">,</span>
            <span class="n">hue</span> <span class="o">=</span> <span class="s1">&#39;Sex&#39;</span><span class="p">,</span>
            <span class="n">sharey</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">kind</span> <span class="o">=</span> <span class="s1">&#39;bar&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;seaborn.axisgrid.FacetGrid at 0x7f0d1d4514f0&gt;
</pre></div>
</div>
<img alt="../../_images/8551bad0ba6a54312c21ebaa36d0192f284e8fc40fb7390833dc2f9e498cb56e.png" src="../../_images/8551bad0ba6a54312c21ebaa36d0192f284e8fc40fb7390833dc2f9e498cb56e.png" />
</div>
</div>
<p>Whether to use melting data and figure-level seaborn functions or using <code class="docutils literal notranslate"><span class="pre">plt.subplots</span></code> and then doing axis-level figure generation is a matter of personal perference and the situation.</p>
<hr class="docutils" />
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./_bblearn/Module06"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../../content/Module06/grammar_of_graphics.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Grammar of Graphics</p>
      </div>
    </a>
    <a class="right-next"
       href="Module06_lab.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Lab</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#learning-objectives">Learning Objectives</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#documentation">Documentation</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#categorical-comparisons">Categorical Comparisons</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#counting-with-countplot">Counting with <code class="docutils literal notranslate"><span class="pre">countplot</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#visualizing-differences-across-categories-with-stripplot">Visualizing differences across categories with <code class="docutils literal notranslate"><span class="pre">stripplot</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quantifying-the-uncertainty-of-estimates">Quantifying the uncertainty of estimates</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#measuring-spread">Measuring Spread</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#measuring-uncertainty">Measuring Uncertainty</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#comparing-distributions">Comparing Distributions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#measuring-correlation">Measuring Correlation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#figure-level-interface">Figure Level Interface</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#categorical-with-catplot">Categorical with <code class="docutils literal notranslate"><span class="pre">catplot</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#relational-with-relplot">Relational with <code class="docutils literal notranslate"><span class="pre">relplot</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#linear-model-regression-plots-with-lmplot">Linear model regression plots with <code class="docutils literal notranslate"><span class="pre">lmplot</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plotting-multiple-columns">Plotting Multiple Columns</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#i-m-pd-melting">I’m <code class="docutils literal notranslate"><span class="pre">pd.melt</span></code>ing</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Will Dampier
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>