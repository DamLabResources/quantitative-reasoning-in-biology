
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Lab &#8212; Quantitative Reasoning in Biology</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=384b581d" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="../../_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=efea14e4"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script async="async" kind="hypothesis" src="https://hypothes.is/embed.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=36754332"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = '_bblearn/Module04/Module04_lab';</script>
    <link rel="canonical" href="https://damlabresources.github.io/quantitative-reasoning-in-biology/_bblearn/Module04/Module04_lab.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Module 5: Plotting with Pandas" href="../../content/Module05/Module05_book.html" />
    <link rel="prev" title="Reshaping Data" href="../../content/Module04/reshaping_data.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../../content/book_index.html">
  
  
  
  
  
  
    <p class="title logo__title">Quantitative Reasoning in Biology</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../content/book_index.html">
                    Quantitative Reasoning in Biology
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Part 0: Introduction</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../content/misc/about_this_book.html">About this book</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Part 1 : Hello World</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../content/Module01/Module01_book.html">Module 1: Hello World</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../content/Module01/notebook_actions.html">Notebook basics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../content/Module01/Module01_walkthrough.html">Walkthrough</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../content/Module02/Module02_book.html">Module 2: Simple calculations</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../content/Module02/dilution_calculations.html">Molarity Calculations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Module02/Module02_walkthrough_SOLUTION.html">Walkthrough</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Module02/Module02_lab.html">Lab</a></li>


</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../content/Module03/Module03_book.html">Module 3: DataFrames</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../content/Module03/spreadsheet_organization.html">Spreadsheet Organization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Module03/Module03_walkthrough_SOLUTION.html">Walkthrough</a></li>

<li class="toctree-l2"><a class="reference internal" href="../Module03/Module03_lab.html">Lab</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Part 2 : Descriptive Statistics</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../../content/Module04/Module04_book.html">Module 4: Analysis by groups</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="Module04_walkthrough_SOLUTION.html">Walkthrough</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../content/Module04/reshaping_data.html">Reshaping Data</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Lab</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../content/Module05/Module05_book.html">Module 5: Plotting with Pandas</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../Module05/Module05_walkthrough_SOLUTION.html">Walkthrough</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Module05/Module05_lab.html">Lab</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../content/Module06/Module06_book.html">Module 6: Visualizing with Confidence</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../content/Module06/grammar_of_graphics.html">Grammar of Graphics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Module06/Module06_walkthrough_SOLUTION.html">Walkthrough</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Module06/Module06_lab.html">Lab</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../content/Module07/Module07_book.html">Module 7: Samples and Replicates</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-7"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../Module07/Module07_walkthrough_SOLUTION.html">Walkthrough</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Module07/Module07_lab.html">Lab</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Part 3 : Inferential Statistics</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../content/Module08/Module08_book.html">Module 8: Hypothesis Testing</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-8"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../Module08/Module08_walkthrough_SOLUTION.html">Walkthrough</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Module08/Module08_lab.html">Lab</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../content/Module09/Module09_book.html">Module 9: Linear Regression</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-9"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../Module09/Module09_walkthrough_SOLUTION.html">Walkthrough</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Module09/Module09_lab.html">Lab</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../content/Module10/Module10_book.html">Module 10: Power Analysis</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-10"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../Module10/Module10_walkthrough_SOLUTION.html">Walkthrough</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Module10/Module10_lab.html">Lab</a></li>

</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Extra</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../content/misc/resources.html">Resources</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-11"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../content/faq.html">Frequently Asked Questions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../content/changelog.html">Change Log</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../content/misc/works_cited.html">Works Cited</a></li>
</ul>
</li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/_bblearn/Module04/Module04_lab.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Lab</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#q1-merge-the-biome-data-table-with-the-sample-information">Q1: Merge the <code class="docutils literal notranslate"><span class="pre">biome_data</span></code> table with the sample information</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#q2-determine-the-predomininant-phylum-across-regions">Q2: Determine the predomininant phylum across regions.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#q3-which-body-site-has-the-largest-increase-in-actinobacteria-when-comparing-typical-and-severe-disease-outcomes">Q3: Which body site has the largest increase in Actinobacteria when comparing typical and severe disease outcomes?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#q4-which-tissues-are-swabbable">Q4: Which tissues are “swabbable”?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#q5-which-samples-are-high">Q5: Which samples are <em>high</em>?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#q6-which-swabbable-region-has-the-highest-positive-predictive-value-when-predicting-persistent-disease">Q6: Which swabbable region has the highest positive predictive value when predicting <strong>persistent</strong> disease?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#q7-context">Q7: Context</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#submission">Submission</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="lab">
<h1>Lab<a class="headerlink" href="#lab" title="Link to this heading">#</a></h1>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Link to this heading">#</a></h2>
<p>In this session, we will delve into the relationship between the microbiome of the sinus system and the severity and duration of sinus infections.
We have classified our patients into three groups: those with typical infections that resolve without complications on standard therapy, those with severe infections that require aggressive medical intervention, and those with persistent infections that relapse shortly after initial symptoms resolve.
Using pivot tables we will compare the microbiomes of these different groups and explore the clinical implications of our findings.
Throughout this lab, you will have the opportunity to practice adding data to a <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>, employing pivot tables to compare microbiomes, describing biostatistical results, and formulating clinical uses for your analysis.</p>
<p>Let’s get started!</p>
<p>In this learning activity you will:</p>
<ul class="simple">
<li><p>Practice adding data into a <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code></p></li>
<li><p>Employ pivot tables to compare microbiomes across disease outcomes</p></li>
<li><p>Describe biostatistical results in “paragraph form”</p></li>
<li><p>Formulate a clinical use for your analysis</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;microbiome_phylum_data.tsv&#39;</span><span class="p">,</span> <span class="n">delimiter</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">data</span>
</pre></div>
</div>
</div>
</div>
<section id="q1-merge-the-biome-data-table-with-the-sample-information">
<h3>Q1: Merge the <code class="docutils literal notranslate"><span class="pre">biome_data</span></code> table with the sample information<a class="headerlink" href="#q1-merge-the-biome-data-table-with-the-sample-information" title="Link to this heading">#</a></h3>
<p>We are interested in exploring the relationship between the microbiome of the sinus system and the severity and duration of a sinus infection.
To do this, we need to first classify each patient into one of three groups:</p>
<ul class="simple">
<li><p>those with a <code class="docutils literal notranslate"><span class="pre">typical</span></code> infection that resolved without complications on standard therapy</p></li>
<li><p>those with a <code class="docutils literal notranslate"><span class="pre">severe</span></code> infection that required aggressive medical intervention</p></li>
<li><p>those with a <code class="docutils literal notranslate"><span class="pre">persistent</span></code> infection that relapsed shortly after the initial symptoms resolved</p></li>
</ul>
<p>By assigning each row of our table with the appropriate outcome, we can begin to compare the microbiomes of these different groups and consider the potential clinical implications of our analysis.</p>
<p>This step is crucial because it allows us to accurately analyze and interpret the data, and is a necessary foundation for the rest of the lab.</p>
<p>Use Pandas to load the <code class="docutils literal notranslate"><span class="pre">sample_info.csv</span></code> file and merge it with the <code class="docutils literal notranslate"><span class="pre">biome_data</span></code>.</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p></p></th>
<th class="head"><p></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Points</p></td>
<td><p>3</p></td>
</tr>
<tr class="row-odd"><td><p>Public Checks</p></td>
<td><p>5</p></td>
</tr>
</tbody>
</table>
<p><em>Points:</em> 3</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load the sample information from sample_info.csv</span>
<span class="c1"># Merge that information with the biome_data</span>

<span class="n">merged_data</span> <span class="o">=</span> <span class="o">...</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">grader</span><span class="o">.</span><span class="n">check</span><span class="p">(</span><span class="s2">&quot;q1_add_outcomes&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="q2-determine-the-predomininant-phylum-across-regions">
<h3>Q2: Determine the predomininant phylum across regions.<a class="headerlink" href="#q2-determine-the-predomininant-phylum-across-regions" title="Link to this heading">#</a></h3>
<p>Use a pivot table to count the number of unique patients that have <code class="docutils literal notranslate"><span class="pre">Actinobacteria</span></code> or <code class="docutils literal notranslate"><span class="pre">Firmicutes</span></code> as the <code class="docutils literal notranslate"><span class="pre">Predominant</span></code> phylum at each body site.</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p></p></th>
<th class="head"><p></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Points</p></td>
<td><p>5</p></td>
</tr>
<tr class="row-odd"><td><p>Public Checks</p></td>
<td><p>7</p></td>
</tr>
<tr class="row-even"><td><p>Hidden Testss</p></td>
<td><p>1</p></td>
</tr>
</tbody>
</table>
<p><em>Points:</em> 5</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create the pivot table described in the question.</span>
<span class="c1"># Pay attention to using the correct `index`, `columns`, `values`, and `aggfunc` parameters</span>
<span class="c1"># It expects the rows to be body-sites</span>
<span class="c1"># The columns to be phylumns</span>
<span class="c1"># And the values to number of unique patients with that predominant phylum at that body-site</span>

<span class="n">q2_pivot</span> <span class="o">=</span> <span class="o">...</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">q2_pivot</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Which regions have at least twice as many patients with Firmicutes as predominant relative to Actinobacteria</span>
<span class="c1"># This should be a subset of the q2_pivot DataFrame</span>
<span class="n">q2_firmi_regions</span> <span class="o">=</span> <span class="o">...</span>
<span class="n">q2_firmi_regions</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">grader</span><span class="o">.</span><span class="n">check</span><span class="p">(</span><span class="s2">&quot;q2_count_pivot&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="q3-which-body-site-has-the-largest-increase-in-actinobacteria-when-comparing-typical-and-severe-disease-outcomes">
<h3>Q3: Which body site has the largest increase in Actinobacteria when comparing typical and severe disease outcomes?<a class="headerlink" href="#q3-which-body-site-has-the-largest-increase-in-actinobacteria-when-comparing-typical-and-severe-disease-outcomes" title="Link to this heading">#</a></h3>
<p>Find which body site has the largest increase in Actinobacteria when comparing typical and severe disease outcomes.
Utilize pivot tables to compare the relative abundances of Actinobacteria across disease states and body sites.</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p></p></th>
<th class="head"><p></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Points</p></td>
<td><p>5</p></td>
</tr>
<tr class="row-odd"><td><p>Public Checks</p></td>
<td><p>8</p></td>
</tr>
<tr class="row-even"><td><p>Hidden Testss</p></td>
<td><p>1</p></td>
</tr>
</tbody>
</table>
<p><em>Points:</em> 5</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a pivot table which averages the count of Actinobacteria across each patient</span>
<span class="c1"># for each body-site and disease type</span>
<span class="n">q3_pivot</span> <span class="o">=</span> <span class="o">...</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Add a relative_abundance column</span>
<span class="c1"># This should be the difference between the severe and typical columns</span>
<span class="n">q3_pivot</span><span class="p">[</span><span class="s1">&#39;relative_abundance&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">...</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Which body site has the largest *increase* in Actinobacteria in those with *severe* disease?</span>

<span class="c1"># Display the table above (optionally with sorting)</span>
<span class="c1"># Or use programatically https://pandas.pydata.org/docs/search.html?q=idxmax</span>
<span class="c1"># Answer as a text string.</span>

<span class="n">q3_ans</span> <span class="o">=</span> <span class="o">...</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">grader</span><span class="o">.</span><span class="n">check</span><span class="p">(</span><span class="s2">&quot;q3_mean_pivot&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The above analysis describes a population level result.
A <em>sample</em> of people with severe disease have more Actinobacteria in some regions than those that have typical disease.
However, that tells us little about the impact on an <em>individual</em>.
Let’s reframe this into a clinical application.</p>
<p>Can you use the amount of Actinobacteria as a predictor of disease?</p>
</section>
<section id="q4-which-tissues-are-swabbable">
<h3>Q4: Which tissues are “swabbable”?<a class="headerlink" href="#q4-which-tissues-are-swabbable" title="Link to this heading">#</a></h3>
<p>If we would like to use microbiome sampling as a clinical assay to detect severe infections, it would be helpful if those areas are “easy to access”.
This dataset is a collection of samples that came from both biopsies and swabs.
Create a subset of the data that only contains <code class="docutils literal notranslate"><span class="pre">Swab</span></code> samples.</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p></p></th>
<th class="head"><p></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Points</p></td>
<td><p>2</p></td>
</tr>
<tr class="row-odd"><td><p>Public Checks</p></td>
<td><p>6</p></td>
</tr>
<tr class="row-even"><td><p>Hidden Testss</p></td>
<td><p>1</p></td>
</tr>
</tbody>
</table>
<p><em>Points:</em> 2</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Use boolean indexing or a query create a new table with only samples that came from samples with data from swabs.</span>
<span class="n">swabbable_data</span> <span class="o">=</span> <span class="o">...</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># What fraction of the data came from swab samples?</span>
<span class="c1"># Your answer should be between 0 and 1.</span>
<span class="n">q4_fraction_swabbable</span> <span class="o">=</span> <span class="p">(</span><span class="n">merged_data</span><span class="p">[</span><span class="s1">&#39;CollectionType&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Swab&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">q4_fraction_swabbable</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="s1">0.2f</span><span class="si">}</span><span class="s1">% of the data came from swabbable samples&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">grader</span><span class="o">.</span><span class="n">check</span><span class="p">(</span><span class="s2">&quot;q4_swabable&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="q5-which-samples-are-high">
<h3>Q5: Which samples are <em>high</em>?<a class="headerlink" href="#q5-which-samples-are-high" title="Link to this heading">#</a></h3>
<p>Previously, we saw that there was more Actinobacteria in across certain regions in severe disease.
In this case, we’ll consider <strong>high</strong> as being 1 standard-deviation above the average of typical patients for that region.</p>
<p>Create a new column in <code class="docutils literal notranslate"><span class="pre">swabbable_data</span></code> called <code class="docutils literal notranslate"><span class="pre">is_high</span></code> that is true if the Actinobacteria is 1 standard-deviation above the average for that region.</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p></p></th>
<th class="head"><p></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Points</p></td>
<td><p>5</p></td>
</tr>
<tr class="row-odd"><td><p>Public Checks</p></td>
<td><p>2</p></td>
</tr>
<tr class="row-even"><td><p>Hidden Testss</p></td>
<td><p>0</p></td>
</tr>
</tbody>
</table>
<p><em>Points:</em> 5</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Isolate the subset of swabbable_data that come from typical disease types</span>
<span class="n">typical_swab_data</span> <span class="o">=</span> <span class="o">...</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Use `groupby()` to aggregate values while keeping the same shape</span>

<span class="n">typical_region_means</span> <span class="o">=</span> <span class="o">...</span>
<span class="n">typical_region_stds</span> <span class="o">=</span> <span class="o">...</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Combine the values to create a cutoff </span>
<span class="n">typical_region_cutoff</span> <span class="o">=</span> <span class="n">typical_region_means</span><span class="o">+</span><span class="n">typical_region_stds</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">typical_region_cutoff</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Add a new column called `is_high`</span>
<span class="c1"># If you&#39;ve done the above cells correctly, this will run.</span>

<span class="c1"># Get the appropriate cutoff into each row</span>
<span class="n">row_cutoff</span> <span class="o">=</span> <span class="n">swabbable_data</span><span class="p">[</span><span class="s1">&#39;Location&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">typical_region_cutoff</span><span class="o">.</span><span class="n">get</span><span class="p">)</span>

<span class="n">swabbable_data</span> <span class="o">=</span> <span class="n">swabbable_data</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">is_high</span> <span class="o">=</span> <span class="n">swabbable_data</span><span class="p">[</span><span class="s1">&#39;Actinobacteria&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">row_cutoff</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">grader</span><span class="o">.</span><span class="n">check</span><span class="p">(</span><span class="s2">&quot;q5_high_values&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="q6-which-swabbable-region-has-the-highest-positive-predictive-value-when-predicting-persistent-disease">
<h3>Q6: Which swabbable region has the highest positive predictive value when predicting <strong>persistent</strong> disease?<a class="headerlink" href="#q6-which-swabbable-region-has-the-highest-positive-predictive-value-when-predicting-persistent-disease" title="Link to this heading">#</a></h3>
<p>The positive predictive value is the ratio of patients truly diagnosed as positive vs all those who had positive test results.
It indicates the likelihood that a patient “has the condition” given a positive test.
This makes PPV one of the most useful metrics when describing diagnostic tests to clinicians and patients.</p>
<p>Use the <code class="docutils literal notranslate"><span class="pre">is_high</span></code> column as a prediction of whether a patient has a persistent infection.
Calculate the PPV for each region.
In the provided space, place the most accurate region and its calculated PPV.</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p></p></th>
<th class="head"><p></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Points</p></td>
<td><p>10</p></td>
</tr>
<tr class="row-odd"><td><p>Public Checks</p></td>
<td><p>3</p></td>
</tr>
<tr class="row-even"><td><p>Hidden Testss</p></td>
<td><p>2</p></td>
</tr>
</tbody>
</table>
<p><em>Points:</em> 10</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># There are a number of ways to approach this problem</span>
<span class="c1"># Look back through the groupby and pivot table explanations</span>


<span class="n">q6_highest_region</span> <span class="o">=</span> <span class="o">...</span>
<span class="n">q6_best_ppv</span> <span class="o">=</span> <span class="o">...</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">grader</span><span class="o">.</span><span class="n">check</span><span class="p">(</span><span class="s2">&quot;q6_swabbable_ppv&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<!-- BEGIN QUESTION -->
</section>
<section id="q7-context">
<h3>Q7: Context<a class="headerlink" href="#q7-context" title="Link to this heading">#</a></h3>
<p>Put these results into context.</p>
<p><em>Points:</em> 5</p>
<p>Write your solution here in this box and consider the following:</p>
<ul class="simple">
<li><p>What are the number 2 and 3 swabbable regions when ranking by PPV?</p></li>
<li><p>How many patients are these results based on?</p></li>
<li><p>Consider the likelihood of persistent infections relative to the PPV. Is the test giving more information compared to a null assumption?</p></li>
</ul>
<!-- END QUESTION -->
</section>
</section>
<hr class="docutils" />
<section id="submission">
<h2>Submission<a class="headerlink" href="#submission" title="Link to this heading">#</a></h2>
<p>Check:</p>
<ul class="simple">
<li><p>That all tables and graphs are rendered properly.</p></li>
<li><p>Code completes without errors by using <code class="docutils literal notranslate"><span class="pre">Restart</span> <span class="pre">&amp;</span> <span class="pre">Run</span> <span class="pre">All</span></code>.</p></li>
<li><p>All checks <strong>pass</strong>.</p></li>
</ul>
<p>Then save the notebook and the <code class="docutils literal notranslate"><span class="pre">File</span></code> -&gt; <code class="docutils literal notranslate"><span class="pre">Download</span></code> -&gt; <code class="docutils literal notranslate"><span class="pre">Download</span> <span class="pre">.ipynb</span></code>. Upload this file to BBLearn.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./_bblearn/Module04"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../../content/Module04/reshaping_data.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Reshaping Data</p>
      </div>
    </a>
    <a class="right-next"
       href="../../content/Module05/Module05_book.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Module 5: Plotting with Pandas</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#q1-merge-the-biome-data-table-with-the-sample-information">Q1: Merge the <code class="docutils literal notranslate"><span class="pre">biome_data</span></code> table with the sample information</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#q2-determine-the-predomininant-phylum-across-regions">Q2: Determine the predomininant phylum across regions.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#q3-which-body-site-has-the-largest-increase-in-actinobacteria-when-comparing-typical-and-severe-disease-outcomes">Q3: Which body site has the largest increase in Actinobacteria when comparing typical and severe disease outcomes?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#q4-which-tissues-are-swabbable">Q4: Which tissues are “swabbable”?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#q5-which-samples-are-high">Q5: Which samples are <em>high</em>?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#q6-which-swabbable-region-has-the-highest-positive-predictive-value-when-predicting-persistent-disease">Q6: Which swabbable region has the highest positive predictive value when predicting <strong>persistent</strong> disease?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#q7-context">Q7: Context</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#submission">Submission</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Will Dampier
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>